/*
 * Fit image to container without altering aspect ratio, prioritising the centre of the image
 * Leon Slater
 * http://mynamesleon.com
 */
window.imageFit=window.imageFit||new function(e){"use strict";var i=[],n="undefined"!=typeof window.document.createElement("div").style.objectFit,t="undefined"!=typeof e,r="undefined"!=typeof window.customResize,c={img:void 0,container:void 0,objectFit:!0,useMargins:!1,resize:!0,customResize:!0,checkOnResize:!1,onPreLoad:function(){},onCheck:function(){},onSet:function(){}},o={extend:function(e,i){var n=e;for(var t in i)i.hasOwnProperty(t)&&(n[t]=i[t]);return n},isNullOrUndefined:function(e){return"undefined"==typeof e||null===e},hasClass:function(i,n){if(t)return e(i).hasClass(n);var r=0,c=i.className.split(" ");for(r;r<c.length;r+=1)if(n===c[r])return!0;return!1},trim:function(e){return String.prototype.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},addClass:function(i,n){if(t)return void e(i).addClass(n);var r=0;for(n=n.split(" "),r;r<n.length;r+=1)o.hasClass(i,n[r])||(i.className=o.trim(i.className)+" "+n[r])},removeClass:function(i,n){if(t)return void e(i).removeClass(n);var r=0;for(n=n.split(" "),r;r<n.length;r+=1)i.className=i.className.replace(n[r],"");i.className=o.trim(i.className)},checkCallback:function(e,i){"function"==typeof e&&e.call(i)}},s={resize:{timer:void 0,bind:function(e,n){return e.resize&&n?e.customResize&&r?void window.customResize.bind(function(){s.resize.check(e)}):void i.push(e):void 0},check:function(e){e.checkOnResize?s.run(e,!1):s.checkAndSet(e)},call:function(){i.length&&(s.resize.timer&&clearTimeout(s.resize.timer),s.resize.timer=setTimeout(function(){var e=0;for(e;e<i.length;e+=1)s.resize.check(i[e])},100))}},checkAndSet:function(e){o.removeClass(e.img,"fitted-tall fitted-wide"),o.checkCallback(e.onCheck,e.img);var i=e.img.clientHeight/e.img.clientWidth*100,n=e.container.clientHeight/e.container.clientWidth*100,t=n>i?"fitted-tall":"fitted-wide";o.addClass(e.img,"fitted "+t),e.useMargins&&(o.addClass(e.img,"fitted-margins"),"fitted-tall"===t?(e.img.style.marginLeft=-(e.img.clientWidth/2)+"px",e.img.style.marginTop=""):(e.img.style.marginLeft="",e.img.style.marginTop=-(e.img.clientHeight/2)+"px")),o.checkCallback(e.onSet,e.img)},run:function(e,i){var t=new Image,r=e.objectFit&&n;return r?void o.addClass(e.img,"fitted fitted-object-fit"):(o.checkCallback(e.onPreLoad,e.img),t.onload=function(){s.checkAndSet(e),s.resize.bind(e,i)},t.onerror=function(){o.addClass(e.img,"fitted-error")},void(t.src=e.img.currentSrc||e.img.src))},init:function(e){o.isNullOrUndefined(e.img)||o.isNullOrUndefined(e.container)||(e.img.length&&(e.img=e.img[0]),e.container.length&&(e.container=e.container[0]),s.run(o.extend(c,e),!0))}};return window.addEventListener?window.addEventListener("resize",s.resize.call):window.attachEvent("onresize",s.resize.call),t&&(e.fn.imageFit=function(e){e.img=this,s.init(e)}),function(e){s.init(e)}}(window.jQuery);